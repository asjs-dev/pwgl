(()=>{var $="currentCallDurationMS,sumFrameDurationMS,startsWith,DEPTH_STENCIL".split(",");let $m=Math,$c=console;let SHOW_CALL_STACKS=1;let SHOW_ORIGINAL_VALUES=2;let SHOW_ARRAYS=4;let enumCheck=(c,b)=>(c&b)===b;let FPSCounter=()=>{let f=0,g=0,h=0,c=Date.now();let d={fps:0,delay:0};d.update=()=>{let b=Date.now();f++;d.delay=(b-c)/16.6667;c=b;if(b>=h){d.fps=(f*1e3)/(b-g);g=b;h=b+1e3;f=0}};return d};let enterFrame=(l,m=0)=>{let b=FPSCounter();let q,j,g,p,d=Date.now(),t,n=0;let r=()=>{b.update();l(b.fps,b.delay)};let s=()=>{let c=Date.now();let f=c-d;if(f>=p){p=2*g-f;d=c;r()}};let k=()=>{if(n){q();t=requestAnimationFrame(k)}};let h={isPlaying:()=>n,clearMaxFPS:()=>{j=1/0;q=r;return h},getMaxFPS:()=>j,setMaxFPS:(m)=>{if(!m||m<=0)return h.clearMaxFPS();j=m;p=g=$m.floor(1e3/j)-1;q=s;return h},start:()=>{if(!n){n=1;k()};return h},stop:()=>{cancelAnimationFrame(t);n=0;return h}};h.setMaxFPS(m).start();return h};let clamp=(b,c,d)=>$m.max(b,$m.min(c,d));let _1l=(b,d,j,m)=>({icon:b,label:d,style:`background: ${m}; color: ${j}; font-family: monospace;`});let _1f={BASE:_1l("- ·","----","#999","#000"),PROGRAM:_1l("- ◉","PROG","#7CFF9B","#0b3d1f"),BINDING:_1l("| ↔","BIND","#4FC3F7","#002233"),RESOURCES:_1l("| □","RSRC","#FFD54F","#3a2a00"),BUFFER_UPLOAD:_1l("| ↑","UPLD","#FF7043","#3b1200"),TEXTURE_PARAMS:_1l("| ▦","TEXT","#c792ea","#2a1433"),UNIFORMS:_1l("| ≡","UNIF","#FF7AA2","#2a0f1a"),VERTEX_ATTRIBUTES:_1l("| ▣","ATTR","#26E6A6","#00382f"),VIEWPORT:_1l("| ▢","FRAM","#90a4ae","#1c262b"),BLENDING:_1l("| ≈","BLND","#69f0ae","#032"),SAMPLERS:_1l("| ⇅","SAMP","#000","#33F"),FRAMEBUFFERS:_1l("| ▭","FBO ","#fff","#4a148c"),RENDERBUFFERS:_1l("| ▩","RBO ","#fff","#004d40"),DEPTH_STENCIL:_1l("| ∠","DPTH","#999","#333"),SHADER:_1l("| ∞","SHDR","#8cedd4","#390b5a"),DRAW:_1l("- ●","DRAW","#fff","#086818"),ALERT:_1l("- ■","ALRT","#fff","#b00020"),WARN:_1l("- ▲","WARN","#000","#fc0")};let _1k=["DEPTH_TEST","CULL_FACE","STENCIL_TEST"];let getFormat=(h,g,c)=>{if(h>5)return _1f.ALERT;if(h>2)return _1f.WARN;switch(g){case"createProgram":case"attachShader":case"linkProgram":case"validateProgram":case"deleteProgram":case"useProgram":return _1f.PROGRAM;case"createShader":case"shaderSource":case"compileShader":case"deleteShader":return _1f.SHADER;case"getBufferSubData":case"finish":case"flush":case"readPixels":return _1f.WARN;case"getError":return _1f.ALERT;case"bindVertexArray":case"bindBuffer":case"activeTexture":case"bindTexture":return _1f.BINDING;case"createBuffer":return _1f.RESOURCES;case"bufferData":case"texImage2D":case"bufferSubData":case"copyBufferSubData":case"texSubImage2D":case"texStorage2D":case"copyTexImage2D":case"copyTexSubImage2D":case"compressedTexImage2D":case"compressedTexSubImage2D":return _1f.BUFFER_UPLOAD;case"texParameteri":case"generateMipmap":return _1f.TEXTURE_PARAMS;case"bindBufferBase":case"bindBufferRange":return _1f.UNIFORMS;case"enableVertexAttribArray":case"vertexAttribPointer":case"vertexAttribDivisor":case"vertexAttribIPointer":case"disableVertexAttribArray":return _1f.VERTEX_ATTRIBUTES;case"viewport":case"scissor":case"clearColor":case"clear":return _1f.VIEWPORT;case"blendEquation":case"blendFuncSeparate":return _1f.BLENDING;case"drawElementsInstanced":case"drawArrays":case"drawElements":case"drawArraysInstanced":case"drawRangeElements":case"drawBuffers":case"drawElementsInstancedBaseVertex":return _1f.DRAW;case"createSampler":case"samplerParameteri":case"bindSampler":case"deleteSampler":return _1f.SAMPLERS;case"createFramebuffer":case"bindFramebuffer":case"framebufferTexture2D":case"framebufferRenderbuffer":case"checkFramebufferStatus":case"blitFramebuffer":return _1f.FRAMEBUFFERS;case"createRenderbuffer":case"bindRenderbuffer":case"renderbufferStorage":case"renderbufferStorageMultisample":return _1f.RENDERBUFFERS;case"depthFunc":case"depthMask":case"cullFace":case"frontFace":case"stencilFunc":case"stencilOp":return _1f[$[3]]};if(g[$[2]]("createTexture"))return _1f.RESOURCES;if(g[$[2]]("uniform"))return _1f.UNIFORMS;if(g[$[2]]("enable")&&_1k.includes(c[0]))return _1f[$[3]];return _1f.BASE};let noopReturnsWith=(b)=>()=>b;let _2G=(q)=>q;let _2K=()=>(new Error).stack.split("\n").slice(3).map((v)=>v.trim().slice(3));let _2T=()=>"\n   | "+_2K().join("\n   | ");let _2r=(z,A={})=>{let O=clamp(A.maxFrameCount??5,0,20),h=A.flags??0,j=[],F=[],D=PWGL?Object.entries(PWGL.Const).reduce((b,[d,k])=>{b[k]=d;return b},{}):{};let H,P,I,R,S,s=-1;let U=(q)=>q.map((v)=>D[v]??v);let L=enumCheck(h,SHOW_ARRAYS)?_2G:(q)=>q.map((v)=>v&&(Array.isArray(v)||v.constructor?.name?.endsWith("Array"))?`[${v.constructor.name}(${v.length})]`:v);let B=enumCheck(h,SHOW_ORIGINAL_VALUES)?_2G:U;let Q=enumCheck(h,SHOW_CALL_STACKS)?_2T:noopReturnsWith("");let t=()=>s++;let E=()=>{j.forEach((l,C)=>{$c.log("%c > FRAME #"+C+" => ","background:#000;color:#00ff00;font-weight:bold;");let R=F[C];l.forEach((m,n)=>{let w=getFormat(m[$[0]],m.prop,U(m.args));$c.log("%c "+w.icon+" "+w.label+"|"+`${String(m[$[1]]).padStart(R[$[1]])}ms|${String(m[$[0]]).padStart(R[$[0]])}ms| ${String(m.prop).padStart(R.prop)}`+(m.args.length?`( ${B(m.args).join(" ")} )`:"")+m.stackTrace,`${w.style}t:${n};`)})})};let M=(k,x,f)=>function(...g){if(s<=O){if(H!==s){I=[];R={};j[s]=I;F[s]=R;H=s;P=Date.now();S=0};if(H>=0){let y=I.length;let c=Date.now();let p=c-P;S+=p;P=c;if(y>0){I[y-1][$[0]]=p;R[$[0]]=$m.max(String(p).length,R[$[0]]??0)};I.push({stackTrace:Q(),currentCallDurationMS:0,sumFrameDurationMS:S,prop:f,args:L(g.map((v)=>[null,undefined].includes(v)?`${v}`:v===""?'""':v))});R[$[1]]=$m.max(String(S).length,R[$[1]]??0);R.prop=$m.max(f.length,R.prop??0)}};return k.apply(x,g)};let N={canvas:z.canvas,snapshots:j,toString:E};enterFrame(t);PWGLDebugger.instances.push(N);$c.log("PWGL Debugger",N);return new Proxy(z,{get(x,f){let k=x[f];return typeof k==="function"?M(k,x,f):k}})};let init=(A={})=>{let J=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(...g){let z=J.call(this,...g);return g[0]&&g[0][$[2]]("webgl")?_2r(z,A):z}};window.PWGLDebugger={version:"0.0.3",SHOW_CALL_STACKS,SHOW_ORIGINAL_VALUES,SHOW_ARRAYS,init,instances:[]};$c.log(`%cPWGL Debugger v${PWGLDebugger.version}\nhttps:\/\/github.com/asjs-dev/pwgl`,"background:#222;color:#0F0");})();