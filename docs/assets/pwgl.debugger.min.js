(()=>{var $="appendChild,currentCallDurationMS,addEventListener,forEach,div,sumFrameDurationMS,padStart,textContent,VERTEX_ATTRIBUTES,startsWith,stopPropagation,TEXTURE_PARAMS,mousedown".split(",");let $m=Math,$d=document;let SHOW_CALL_STACKS=1;let SHOW_ORIGINAL_VALUES=2;let SHOW_ARRAYS=4;let enumCheck=(c,b)=>(c&b)===b;let FPSCounter=()=>{let f=0,g=0,h=0,c=Date.now();let d={fps:0,delay:0};d.update=()=>{let b=Date.now();f++;d.delay=(b-c)/16.6667;c=b;if(b>=h){d.fps=(f*1e3)/(b-g);g=b;h=b+1e3;f=0}};return d};let enterFrame=(l,m=0)=>{let b=FPSCounter();let q,j,g,p,d=Date.now(),t,n=0;let r=()=>{b.update();l(b.fps,b.delay)};let s=()=>{let c=Date.now();let f=c-d;if(f>=p){p=2*g-f;d=c;r()}};let k=()=>{if(n){q();t=requestAnimationFrame(k)}};let h={isPlaying:()=>n,clearMaxFPS:()=>{j=1/0;q=r;return h},getMaxFPS:()=>j,setMaxFPS:(m)=>{if(!m||m<=0)return h.clearMaxFPS();j=m;p=g=$m.floor(1e3/j)-1;q=s;return h},start:()=>{if(!n){n=1;k()};return h},stop:()=>{cancelAnimationFrame(t);n=0;return h}};h.setMaxFPS(m).start();return h};let clamp=(b,c,d)=>$m.max(b,$m.min(c,d));let noopReturnsWith=(b)=>()=>b;let _1z=(m)=>m;let _1J=()=>"\n\n<i>Stack trace:\n| "+(new Error).stack.split("\n").slice(3).map((v)=>{let x=v.trim().slice(3).split(" (");return x[1]?"<a href=\""+x[1].slice(0,-1)+"\" target=\"_blank\">"+x[0]+"</a>":v}).join("\n| ")+"</i>";let _1E=(m)=>m.map((v)=>v&&(Array.isArray(v)||v.constructor?.name?.endsWith("Array"))?`[${v.constructor.name}(${v.length})]`:v);let debugContext=(s,t={})=>{let F=clamp(t.maxFrameCount??5,0,20),h=t.flags??0,j=[],y=PWGL?Object.entries(PWGL.Const).reduce((b,[d,k])=>{b[k]=d;return b},{}):{};let A,G,B,I,n=-1;let K=(m)=>m.map((v)=>y[v]??v);let C=enumCheck(h,SHOW_ARRAYS)?_1z:_1E;let w=enumCheck(h,SHOW_ORIGINAL_VALUES)?_1z:K;let H=enumCheck(h,SHOW_CALL_STACKS)?_1J:noopReturnsWith("");let p=()=>n++;let D=(k,q,f)=>function(...g){if(n<=F){if(A!==n){B=[];j[n]=B;A=n;G=Date.now();I=0};if(A>=0){let r=B.length,c=Date.now(),l=c-G;I+=l;G=c;if(r>0)B[r-1][$[1]]=l;B.push({stackTrace:H(),currentCallDurationMS:0,sumFrameDurationMS:I,prop:f,args:w(C(g.map((v)=>[null,undefined].includes(v)?`${v}`:v===""?'""':v)))})}};return k.apply(q,g)};enterFrame(p);PWGLDebugger.instances.push({canvas:s.canvas,snapshots:j});return new Proxy(s,{get(q,f){let k=q[f];return typeof k==="function"?D(k,q,f):k}})};let TYPES={FRAME:"FRAME",BASE:"    ",PROGRAM:"PROG",BINDING:"BIND",RESOURCES:"RSRC",BUFFER_UPLOAD:"UPLD",TEXTURE_PARAMS:"TEXT",UNIFORMS:"UNIF",VERTEX_ATTRIBUTES:"ATTR",VIEWPORT:"VIEW",BLENDING:"BLND",SAMPLERS:"SAMP",FRAMEBUFFERS:"FBO ",RENDERBUFFERS:"RBO ",DEPTH_STENCIL:"DPTH",SHADER:"SHDR",DRAW:"DRAW",ALERT:"ALRT",WARN:"WARN"};let COLORS=[{icon:"",label:TYPES.FRAME,color:"#0f0",bg:"#000"},{icon:"-",label:TYPES.BASE,color:"#999",bg:"#111"},{icon:"◉",label:TYPES.PROGRAM,color:"#7CFF9B",bg:"#0b3d1f"},{icon:"↔",label:TYPES.BINDING,color:"#4FC3F7",bg:"#002233"},{icon:"□",label:TYPES.RESOURCES,color:"#FFD54F",bg:"#3a2a00"},{icon:"↑",label:TYPES.BUFFER_UPLOAD,color:"#FF7043",bg:"#3b1200"},{icon:"▦",label:TYPES[$[11]],color:"#c792ea",bg:"#2a1433"},{icon:"≡",label:TYPES.UNIFORMS,color:"#FF7AA2",bg:"#2a0f1a"},{icon:"▣",label:TYPES[$[8]],color:"#26E6A6",bg:"#00382f"},{icon:"▢",label:TYPES.VIEWPORT,color:"#90a4ae",bg:"#1c262b"},{icon:"≈",label:TYPES.BLENDING,color:"#69f0ae",bg:"#032"},{icon:"⇅",label:TYPES.SAMPLERS,color:"#000",bg:"#33F"},{icon:"▭",label:TYPES.FRAMEBUFFERS,color:"#fff",bg:"#4a148c"},{icon:"▩",label:TYPES.RENDERBUFFERS,color:"#fff",bg:"#004d40"},{icon:"∠",label:TYPES.DEPTH_STENCIL,color:"#999",bg:"#333"},{icon:"∞",label:TYPES.SHADER,color:"#8cedd4",bg:"#390b5a"},{icon:"●",label:TYPES.DRAW,color:"#fff",bg:"#086818"},{icon:"■",label:TYPES.ALERT,color:"#fff",bg:"#b00020"},{icon:"▲",label:TYPES.WARN,color:"#000",bg:"#fc0"}];let getFormat=(c,b)=>{if(c>5)return TYPES.ALERT;if(c>2)return TYPES.WARN;switch(b){case"createProgram":case"attachShader":case"linkProgram":case"validateProgram":case"deleteProgram":case"useProgram":return TYPES.PROGRAM;case"createShader":case"shaderSource":case"compileShader":case"deleteShader":return TYPES.SHADER;case"getBufferSubData":case"finish":case"flush":case"readPixels":return TYPES.WARN;case"getError":return TYPES.ALERT;case"bindVertexArray":case"bindBuffer":case"activeTexture":case"bindTexture":return TYPES.BINDING;case"createBuffer":return TYPES.RESOURCES;case"bufferData":case"texImage2D":case"bufferSubData":case"copyBufferSubData":case"texSubImage2D":case"texStorage2D":case"copyTexImage2D":case"copyTexSubImage2D":case"compressedTexImage2D":case"compressedTexSubImage2D":return TYPES.BUFFER_UPLOAD;case"texParameteri":case"generateMipmap":return TYPES[$[11]];case"bindBufferBase":case"bindBufferRange":return TYPES.UNIFORMS;case"enableVertexAttribArray":case"vertexAttribPointer":case"vertexAttribDivisor":case"vertexAttribIPointer":case"disableVertexAttribArray":return TYPES[$[8]];case"viewport":case"scissor":case"clearColor":case"clear":return TYPES.VIEWPORT;case"blendEquation":case"blendFuncSeparate":return TYPES.BLENDING;case"drawElementsInstanced":case"drawArrays":case"drawElements":case"drawArraysInstanced":case"drawRangeElements":case"drawBuffers":case"drawElementsInstancedBaseVertex":return TYPES.DRAW;case"createSampler":case"samplerParameteri":case"bindSampler":case"deleteSampler":return TYPES.SAMPLERS;case"createFramebuffer":case"bindFramebuffer":case"framebufferTexture2D":case"framebufferRenderbuffer":case"checkFramebufferStatus":case"blitFramebuffer":return TYPES.FRAMEBUFFERS;case"createRenderbuffer":case"bindRenderbuffer":case"renderbufferStorage":case"renderbufferStorageMultisample":return TYPES.RENDERBUFFERS;case"depthFunc":case"depthMask":case"cullFace":case"frontFace":case"stencilFunc":case"stencilOp":return TYPES.DEPTH_STENCIL};if(b[$[9]]("createTexture"))return TYPES.RESOURCES;if(b[$[9]]("uniform"))return TYPES.UNIFORMS;return TYPES.BASE};let _2c=String($m.random()).split(".")[1],_2j="*[hidden] {display:none !important;}*[class*=\"-"+_2c+"\"],*[class*=\"-"+_2c+"\"] > * {box-sizing:border-box;}.info-button-"+_2c+" {position:fixed;top:10px;left:10px;width:20px;height:20px;border-radius:100%;opacity:.2;background:#0097e6;color:white;font-size:16px;transition:opacity 250ms linear;cursor:pointer;z-index:99999999;display:flex;align-items:center;justify-content:center;font-family:monospace;box-shadow:0 0 10px 0 rgba(0,0,0,.6);}.info-button-"+_2c+":after {content:\"i\";}.info-button-"+_2c+":hover {opacity:1;}.debugger-container-"+_2c+" {position:fixed;top:0;left:0;right:0;bottom:0;z-index:99999999;background:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center;background-image:linear-gradient(45deg,#00000075 25%,transparent 25%,transparent 50%,#00000075 50%,#00000075 75%,transparent 75%);background-size:8px 8px;}.debugger-panel-"+_2c+" {min-width:320px;min-height:240px;width:90vw;max-width:960px;background:rgba(0,0,0,.5);position:relative;padding:10px;gap:10px;display:flex;flex-direction:column;box-shadow:0 0 30px rgba(0,0,0,.35);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2);border-radius:3px;}.panel-container-"+_2c+" {display:flex;flex-direction:row;align-items:center;gap:10px;}.panel-container-bottom-"+_2c+" {height:70vh;gap:5px;}.panel-title-"+_2c+" {color:white;font-size:16px;font-family:Arial;width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-left:5px;}.close-button-"+_2c+" {width:20px;height:20px;cursor:pointer;display:flex;align-items:center;justify-content:center;color:white;font-size:16px;}.close-button-"+_2c+":after {content:\"✖\";}.instance-list-"+_2c+" {width:120px;height:100%;padding:0;margin:0;overflow:auto;}.instance-button-"+_2c+" {padding:4px 6px;background:black;font-family:Arial;font-size:14px;color:white;transition:opacity 250ms linear;cursor:pointer;overflow:hidden;text-overflow:ellipsis;font-weight:bold;white-space:nowrap;opacity:.75;}.instance-button-"+_2c+":hover {opacity:1;}.output-"+_2c+" {width:100%;height:100%;padding:1px;background:rgba(0,0,0,.75);overflow:scroll;display:flex;flex-direction:column;gap:2px;margin:0;scrollbar-width:none;}.output-"+_2c+" span {min-width:fit-content;width:100%;text-wrap-mode:wrap;word-break:break-word;border:1px solid rgba(255,255,255,0);transition:all 250ms linear;cursor:pointer;padding:3px 6px;}.output-"+_2c+" span:hover {border:1px solid rgba(255,255,255,.5);}"+COLORS.map((v)=>".output-"+_2c+" span[type=\""+v.label+"\"] {background:"+v.bg+";color:"+v.color+";}.output-"+_2c+" span[type=\""+v.label+"\"]:before {content:\""+v.icon+" "+v.label+" \";}").join("")+".output-"+_2c+" span a {color:inherit;}";let _2J=(x=$[4],s=[])=>{let n=$d.createElement(x);n.classList.add(...s);return n};let _2C=(y,q)=>`<span type=\"${q}\">${y}</span>\n`;let panel=()=>{let D=_2J("style");D[$[7]]=_2j;let t=_2J($[4],["info-button-"+_2c]),L=_2J($[4],["debugger-container-"+_2c]),H=_2J($[4],["debugger-panel-"+_2c]),M=_2J($[4],["panel-container-"+_2c]),O=_2J($[4],["panel-container-"+_2c,"panel-container-bottom-"+_2c]),w=_2J($[4],["panel-title-"+_2c]),z=_2J($[4],["close-button-"+_2c]),E=_2J("ul",["instance-list-"+_2c]),k=_2J("pre",["output-"+_2c]);w[$[7]]="WebGL2 debug panel";let F=()=>L.removeAttribute("hidden"),G=()=>L.setAttribute("hidden",null),A=(b)=>{let r=PWGLDebugger.instances[b];if(r){let l="",P=0,Q=0,I=0;r.snapshots[$[3]]((d)=>d[$[3]]((f)=>{P=$m.max(P,String(f[$[5]]).length);Q=$m.max(Q,String(f[$[1]]).length);I=$m.max(I,f.prop.length)}));let B=String("")[$[6]](14+P+Q+I);r.snapshots[$[3]]((d,p)=>{l+=_2C("#"+p,TYPES.FRAME);d[$[3]]((f)=>{let m=getFormat(f[$[1]],f.prop);l+=_2C(`${String(f[$[5]])[$[6]](P)}ms ${String(f[$[1]])[$[6]](Q)}ms ${String(f.prop)[$[6]](I)} `+(f.args.length?f.args.join("\n"+B):"")+f.stackTrace,m)})});k.innerHTML=l}},N=()=>{[...E.children][$[3]]((g)=>g.remove());PWGLDebugger.instances[$[3]]((r,b)=>{let K=_2J($[4],["instance-button-"+_2c]);K.setAttribute("instance-id",b);K[$[7]]=`#${b + 1} Canvas`;E[$[0]](K);b===0&&A(0)})};G();t[$[2]]($[12],(h)=>{h[$[10]]();N();F()});z[$[2]]("click",G);E[$[2]]("click",(h)=>A(parseInt(h.target.getAttribute("instance-id"))));L[$[2]]($[12],(h)=>h[$[10]]());M[$[0]](w);M[$[0]](z);O[$[0]](E);O[$[0]](k);H[$[0]](M);H[$[0]](O);L[$[0]](H);$d.body[$[0]](D);$d.body[$[0]](t);$d.body[$[0]](L)};let init=(c={})=>{panel();let f=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(...b){let d=f.call(this,...b);return b[0]&&b[0][$[9]]("webgl")?debugContext(d,c):d}};window.PWGLDebugger={version:"0.0.3",SHOW_CALL_STACKS,SHOW_ORIGINAL_VALUES,SHOW_ARRAYS,init,instances:[]};console.log(`%cPWGL Debugger v${PWGLDebugger.version}\nhttps:\/\/github.com/asjs-dev/pwgl`,"background:#222;color:#0F0");})();