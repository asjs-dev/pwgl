(()=>{var $="currentCallDurationMS,sumFrameDurationMS,startsWith,DEPTH_STENCIL".split(",");let $m=Math,$c=console;let SHOW_CALL_STACKS=1;let SHOW_ORIGINAL_VALUES=2;let SHOW_ARRAYS=4;let enumCheck=(c,b)=>(c&b)===b;let noop=()=>{};let FPS=(()=>{let d={fps:0,delay:0};let g=16.6667;let f=0,h=0,j=0,c=Date.now();d.update=()=>{let b=Date.now();f++;d.delay=(b-c)/g;c=b;if(b>=j){d.fps=(f*1e3)/(b-h);h=b;j=b+1e3;f=0}};d.init=d.start=noop;return d})();let enterFrame=(k,l=0)=>{let f={};let p,h,g,n,c=Date.now(),s,m=0;let q=()=>{FPS.update();k(FPS.fps,FPS.delay)};let r=()=>{let b=Date.now();let d=b-c;if(d>=n){n=2*g-d;c=b;q()}};let j=()=>{if(m){p();s=requestAnimationFrame(j)}};f.isPlaying=()=>m;f.clearMaxFPS=()=>{h=1/0;p=q};f.getMaxFPS=()=>h;f.setMaxFPS=(l)=>{if(!l||l<=0)return f.clearMaxFPS();h=l;n=g=$m.floor(1e3/h)-1;p=r};f.start=()=>{if(!m){m=1;j()}};f.stop=()=>{cancelAnimationFrame(s);m=0};f.setMaxFPS(l);f.start();return f};let clamp=(b,c,d)=>$m.max(b,$m.min(c,d));let _1l=(b,d,j,m)=>({icon:b,label:d,style:`background: ${m}; color: ${j}; font-family: monospace;`});let _1f={BASE:_1l("·","----","#999","#000"),PROGRAM:_1l("◉","PROG","#7CFF9B","#0b3d1f"),BINDING:_1l("↔","BIND","#4FC3F7","#002233"),RESOURCES:_1l("□","RESOURCE","#FFD54F","#3a2a00"),BUFFER_UPLOAD:_1l("↑","UPLD","#FF7043","#3b1200"),TEXTURE_PARAMS:_1l("▦","TEXT","#c792ea","#2a1433"),UNIFORMS:_1l("≡","UNIF","#FF7AA2","#2a0f1a"),VERTEX_ATTRIBUTES:_1l("▣","ATTR","#26E6A6","#00382f"),VIEWPORT:_1l("▢","FRAM","#90a4ae","#1c262b"),BLENDING:_1l("≈","BLND","#69f0ae","#032"),SAMPLERS:_1l("⇅","SAMP","#000","#33F"),FRAMEBUFFERS:_1l("▭","FBO ","#fff","#4a148c"),RENDERBUFFERS:_1l("▩","RBO ","#fff","#004d40"),DEPTH_STENCIL:_1l("∠","DPTH","#999","#333"),DRAW:_1l("●","DRAW","#fff","#d50000"),ALERT:_1l("■","ALRT","#fff","#b00020"),WARN:_1l("▲","WARN","#000","#fc0")};let _1k=["DEPTH_TEST","CULL_FACE","STENCIL_TEST"];let getFormat=(h,g,c)=>{if(h>5)return _1f.ALERT;if(h>2)return _1f.WARN;switch(g){case"createProgram":case"attachShader":case"linkProgram":case"validateProgram":case"deleteProgram":case"useProgram":return _1f.PROGRAM;case"createShader":case"shaderSource":case"compileShader":case"deleteShader":case"getBufferSubData":case"finish":case"flush":case"readPixels":return _1f.WARN;case"getError":return _1f.ALERT;case"bindVertexArray":case"bindBuffer":case"activeTexture":case"bindTexture":return _1f.BINDING;case"createBuffer":return _1f.RESOURCES;case"bufferData":case"texImage2D":case"bufferSubData":case"copyBufferSubData":case"texSubImage2D":case"texStorage2D":case"copyTexImage2D":case"copyTexSubImage2D":case"compressedTexImage2D":case"compressedTexSubImage2D":return _1f.BUFFER_UPLOAD;case"texParameteri":case"generateMipmap":return _1f.TEXTURE_PARAMS;case"bindBufferBase":case"bindBufferRange":return _1f.UNIFORMS;case"enableVertexAttribArray":case"vertexAttribPointer":case"vertexAttribDivisor":case"vertexAttribIPointer":case"disableVertexAttribArray":return _1f.VERTEX_ATTRIBUTES;case"viewport":case"scissor":case"clearColor":case"clear":return _1f.VIEWPORT;case"blendEquation":case"blendFuncSeparate":return _1f.BLENDING;case"drawElementsInstanced":case"drawArrays":case"drawElements":case"drawArraysInstanced":case"drawRangeElements":case"drawBuffers":case"drawElementsInstancedBaseVertex":return _1f.DRAW;case"createSampler":case"samplerParameteri":case"bindSampler":case"deleteSampler":return _1f.SAMPLERS;case"createFramebuffer":case"bindFramebuffer":case"framebufferTexture2D":case"framebufferRenderbuffer":case"checkFramebufferStatus":case"blitFramebuffer":return _1f.FRAMEBUFFERS;case"createRenderbuffer":case"bindRenderbuffer":case"renderbufferStorage":case"renderbufferStorageMultisample":return _1f.RENDERBUFFERS;case"depthFunc":case"depthMask":case"cullFace":case"frontFace":case"stencilFunc":case"stencilOp":return _1f[$[3]]};if(g[$[2]]("createTexture"))return _1f.RESOURCES;if(g[$[2]]("uniform"))return _1f.UNIFORMS;if(g[$[2]]("enable")&&_1k.includes(c[0]))return _1f[$[3]];return _1f.BASE};let noopReturnsWith=(b)=>()=>b;let _2F=(p)=>p;let _2J=()=>"\n |"+(new Error).stack.split("\n").slice(3).map((v)=>v.trim().slice(3)).join("\n |");let _2q=(y,z={})=>{let N=clamp(z.maxFrameCount??5,0,20);let h=z.flags??0;let j=[];let E=[];let C=PWGL?Object.entries(PWGL.Const).reduce((b,[d,k])=>{b[k]=d;return b},{}):{};let G;let O;let H;let Q;let R;let r=-1;let S=(p)=>p.map((v)=>C[v]??v);let K=enumCheck(h,SHOW_ARRAYS)?_2F:(p)=>p.map((v)=>v&&(Array.isArray(v)||v.constructor?.name?.endsWith("Array"))?`[${v.constructor.name}(${v.length})]`:v);let A=enumCheck(h,SHOW_ORIGINAL_VALUES)?_2F:S;let P=enumCheck(h,SHOW_CALL_STACKS)?_2J:noopReturnsWith("");let s=()=>r++;let D=()=>{j.forEach((l,B)=>{$c.log("%c > FRAME #"+B+" => ","background:#000;color:#00ff00;font-weight:bold;");let Q=E[B];l.forEach((m)=>{let t=getFormat(m[$[0]],m.prop,S(m.args));$c.log("%c "+t.icon+" "+t.label+"|"+`${String(m[$[1]]).padStart(Q[$[1]])}ms|${String(m[$[0]]).padStart(Q[$[0]])}ms| ${String(m.prop).padStart(Q.prop)}`+(m.args.length?`( ${A(m.args).join(" ")} )`:"")+m.stackTrace,t.style)})})};let L=(k,w,f)=>function(...g){if(r<=N){if(G!==r){H=[];Q={};j[r]=H;E[r]=Q;G=r;O=Date.now();R=0};if(G>=0){let x=H.length;let c=Date.now();let n=c-O;R+=n;O=c;if(x>0){H[x-1][$[0]]=n;Q[$[0]]=$m.max(String(n).length,Q[$[0]]??0)};H.push({stackTrace:P(),currentCallDurationMS:0,sumFrameDurationMS:R,prop:f,args:K(g)});Q[$[1]]=$m.max(String(R).length,Q[$[1]]??0);Q.prop=$m.max(f.length,Q.prop??0)}};return k.apply(w,g)};let M={canvas:y.canvas,snapshots:j,toString:D};enterFrame(s);PWGLDebugger.instances.push(M);$c.log("PWGL Debugger",M);return new Proxy(y,{get(w,f){let k=w[f];return typeof k==="function"?L(k,w,f):k}})};let init=(z={})=>{let I=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(...g){let y=I.call(this,...g);return g[0]&&g[0][$[2]]("webgl")?_2q(y,z):y}};window.PWGLDebugger={version:"0.0.2",SHOW_CALL_STACKS,SHOW_ORIGINAL_VALUES,SHOW_ARRAYS,init,instances:[]};$c.log(`%cPWGL Debugger v${PWGLDebugger.version}\nhttps:\/\/github.com/asjs-dev/pwgl`,"background:#222;color:#0F0");})();