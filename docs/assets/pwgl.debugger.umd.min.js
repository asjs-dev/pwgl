!function(t){"function"==typeof define&&define.amd?define(t):t()}(function(){"use strict";const t=(t,n)=>(t&n)===n,n=()=>{},e=(()=>{const t={fps:0,delay:0};let e=0,s=0,o=0,r=Date.now();return t.update=()=>{const n=Date.now();e++,t.delay=(n-r)/16.6667,r=n,n>=o&&(t.fps=1e3*e/(n-s),s=n,o=n+1e3,e=0)},t.init=t.start=n,t})(),s=t=>t,o=(t,n)=>function(...e){return t.apply(n,e)},r=n=>{const r=[],a=new Map,c=PWGL?Object.entries(PWGL.Const).reduce((t,n)=>(t[n[1]]=n[0],t),{}):{};let i,u,l,p,g=(t,n,e,s)=>function(...s){if("useProgram"===e){const t=s[0];r.includes(t)?i=null:(r.push(t),a.set(t,[]),i=t,u=Date.now(),l=0)}if(i){const t=Date.now(),n=t-u;l+=n,u=t,a.get(i).push(["\n"+(new Error).stack.split("\n").slice(3).map(t=>t.trim().slice(3)).join("\n")+"\n->",`frame ${f}`,`[${n}ms]`,`[${l}ms]:`,e,...s])}return t.apply(n,s)},f=0;p=((t,n=0)=>{const s={};let o,r,a,c,i,u=Date.now(),l=!1;const p=()=>{e.update(),t(e.fps,e.delay)},g=()=>{const t=Date.now(),n=t-u;n>=c&&(c=2*a-n,u=t,p())},f=()=>{l&&(o(),i=requestAnimationFrame(f))};return s.isPlaying=()=>l,s.clearMaxFPS=()=>{r=1/0,o=p},s.getMaxFPS=()=>r,s.setMaxFPS=t=>{if(!t||t<=0)return s.clearMaxFPS();r=t,c=a=Math.floor(1e3/r)-1,o=g},s.start=()=>{l||(l=!0,f())},s.stop=()=>{cancelAnimationFrame(i),l=!1},s.setMaxFPS(n),s.start(),s})(()=>{2===f&&(p.stop(),g=o),f++});const m={canvas:n.canvas,snapshots:a,toString:(n=0)=>{const e=t(n,1),o=t(n,4)?s:t=>t.map(t=>t&&(Array.isArray(t)||t.constructor.name.endsWith("Array"))?`[${t.constructor.name}(${t.length})]`:t),r=t(n,2)?t=>t.map(t=>c[t]??t):s,i=[];return a.forEach((t,n)=>i.push(t.map(t=>r(o(t.slice(e?0:1))).join(" ")).join("\n"))),i}};return PWGLDebugger.instances.push(m),console.log("PWGL Debugger",m),new Proxy(n,{get(t,n){const e=t[n];return"function"==typeof e?g(e,t,n):e}})};window.PWGLDebugger={version:"0.0.1",SHOW_CALL_STACK:1,SHOW_READABLE_NAMES:2,SHOW_ARRAYS:4,init:()=>{const t=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(...n){const e=t.call(this,...n);return n[0].startsWith("webgl")?r(e):e}},instances:[]},console.log(`%cPWGL Debugger v${PWGLDebugger.version}\nhttps://github.com/asjs-dev/pwgl`,"background:#222;color:#0F0")});
