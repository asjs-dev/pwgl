const e=(e,a)=>(e&a)===a,a=()=>{},r=(()=>{const e={fps:0,delay:0};let r=0,t=0,s=0,c=Date.now();return e.update=()=>{const a=Date.now();r++,e.delay=(a-c)/16.6667,c=a,a>=s&&(e.fps=1e3*r/(a-t),t=a,s=a+1e3,r=0)},e.init=e.start=a,e})(),t=(e,a,r,t)=>({icon:e,label:a,style:`background: ${t}; color: ${r};`}),s={BASE:t("Â·","    ","#999","#000"),PROGRAM:t("ðŸ§ ","PROGRAM","#7CFF9B","#0b3d1f"),BINDING:t("ðŸ”—","BIND","#4FC3F7","#002233"),RESOURCES:t("ðŸ“¦","RESOURCE","#FFD54F","#3a2a00"),BUFFER_UPLOAD:t("ðŸšš","UPLOAD","#FF7043","#3b1200"),TEXTURE_PARAMS:t("ðŸ–¼ï¸","TEX","#c792ea","#2a1433"),UNIFORMS:t("ðŸŽ›ï¸","UNIFORM","#FF7AA2","#2a0f1a"),VERTEX_ATTRIBUTES:t("ðŸ§©","ATTR","#26E6A6","#00382f"),VIEWPORT:t("ðŸ–¥ï¸","FRAME","#90a4ae","#1c262b"),BLENDING:t("ðŸŒ«ï¸","BLEND","#69f0ae","#032"),SAMPLERS:t("ðŸŽšï¸","SAMPLER","#000","#33F"),FRAMEBUFFERS:t("ðŸªŸ","FBO","#fff","#4a148c"),RENDERBUFFERS:t("ðŸ§±","RBO","#fff","#004d40"),DEPTH_STENCIL:t("ðŸ“","DEPTH","#999","#333"),DRAW:t("ðŸ”´","DRAW","#fff","#d50000"),ALERT:t("ðŸ›‘","ALERT","#fff","#b00020"),WARN:t("âš ï¸","WARN","#000","#fc0")},c=["DEPTH_TEST","CULL_FACE","STENCIL_TEST"],n=e=>e,o=(a,t=2)=>{const o=[],u=/* @__PURE__ */new Map,l=PWGL?Object.entries(PWGL.Const).reduce((e,a)=>(e[a[1]]=a[0],e),{}):{},f=e=>e.map(e=>l[e]??e);let i,E,S,R,d=0;R=((e,a=0)=>{const t={};let s,c,n,o,u,l=Date.now(),f=!1;const i=()=>{r.update(),e(r.fps,r.delay)},E=()=>{const e=Date.now(),a=e-l;a>=o&&(o=2*n-a,l=e,i())},S=()=>{f&&(s(),u=requestAnimationFrame(S))};return t.isPlaying=()=>f,t.clearMaxFPS=()=>{c=1/0,s=i},t.getMaxFPS=()=>c,t.setMaxFPS=e=>{if(!e||e<=0)return t.clearMaxFPS();c=e,o=n=Math.floor(1e3/c)-1,s=E},t.start=()=>{f||(f=!0,S())},t.stop=()=>{cancelAnimationFrame(u),f=!1},t.setMaxFPS(a),t.start(),t})(()=>{d===t&&R.stop(),d++});const m={canvas:a.canvas,snapshots:u,toString:(a=0)=>{const r=e(a,1),t=e(a,4)?n:e=>e.map(e=>e&&(Array.isArray(e)||e.constructor.name.endsWith("Array"))?`[${e.constructor.name}(${e.length})]`:e),o=e(a,2)?n:f;let l=0;u.forEach(e=>{console.log(`%c < CONTEXT #${++l} > `,"background: #000; color: #00ff00; font-weight: bold;"),e.map(e=>{const a=((e,a,r)=>{if(e>5)return s.ALERT;if(e>2)return s.WARN;switch(a){case"createProgram":case"attachShader":case"linkProgram":case"validateProgram":case"deleteProgram":case"useProgram":return s.PROGRAM;case"createShader":case"shaderSource":case"compileShader":case"deleteShader":case"getBufferSubData":case"finish":case"flush":case"readPixels":return s.WARN;case"getError":return s.ALERT;case"bindVertexArray":case"bindBuffer":case"activeTexture":case"bindTexture":return s.BINDING;case"createBuffer":return s.RESOURCES;case"bufferData":case"texImage2D":case"bufferSubData":case"copyBufferSubData":case"texSubImage2D":case"texStorage2D":case"copyTexImage2D":case"copyTexSubImage2D":case"compressedTexImage2D":case"compressedTexSubImage2D":return s.BUFFER_UPLOAD;case"texParameteri":case"generateMipmap":return s.TEXTURE_PARAMS;case"bindBufferBase":case"bindBufferRange":return s.UNIFORMS;case"enableVertexAttribArray":case"vertexAttribPointer":case"vertexAttribDivisor":case"vertexAttribIPointer":case"disableVertexAttribArray":return s.VERTEX_ATTRIBUTES;case"viewport":case"scissor":case"clearColor":case"clear":return s.VIEWPORT;case"blendEquation":case"blendFuncSeparate":return s.BLENDING;case"drawElementsInstanced":case"drawArrays":case"drawElements":case"drawArraysInstanced":case"drawRangeElements":case"drawBuffers":case"drawElementsInstancedBaseVertex":return s.DRAW;case"createSampler":case"samplerParameteri":case"bindSampler":case"deleteSampler":return s.SAMPLERS;case"createFramebuffer":case"bindFramebuffer":case"framebufferTexture2D":case"framebufferRenderbuffer":case"checkFramebufferStatus":case"blitFramebuffer":return s.FRAMEBUFFERS;case"createRenderbuffer":case"bindRenderbuffer":case"renderbufferStorage":case"renderbufferStorageMultisample":return s.RENDERBUFFERS;case"depthFunc":case"depthMask":case"cullFace":case"frontFace":case"stencilFunc":case"stencilOp":return s.DEPTH_STENCIL}return a.startsWith("createTexture")?s.RESOURCES:a.startsWith("uniform")?s.UNIFORMS:a.startsWith("enable")&&c.includes(r[0])?s.DEPTH_STENCIL:s.BASE})(e.lastCallMS,e.prop,f(e.args));console.log("%c"+a.icon+` ${a.label}: `+[...r?[e.stackTrace]:[],`frame #${e.frame}`,`${e.sumMS}ms`,`${e.lastCallMS}ms`,`[${e.prop}]`,`( ${o(t(e.args)).join(", ")} )`].join(" | "),a.style)})})}};return PWGLDebugger.instances.push(m),console.log("PWGL Debugger",m),new Proxy(a,{get(e,a){const r=e[a];return"function"==typeof r?((e,a,r)=>function(...s){if(d<=t){if("useProgram"===r){const e=s[0];o.includes(e)?i=null:(o.push(e),u.set(e,[]),i=e,E=Date.now(),S=0)}if(i){const e=u.get(i),a=e.length,t=Date.now(),c=t-E;S+=c,E=t,a>0&&(e[a-1].lastCallMS=c),e.push({stackTrace:"\n"+(new Error).stack.split("\n").slice(3).map(e=>e.trim().slice(3)).join("\n")+"\n->",frame:d,lastCallMS:0,sumMS:S,prop:r,args:s})}}return e.apply(a,s)})(r,e,a):r}})};window.PWGLDebugger={version:"0.0.2",SHOW_CALL_STACK:1,SHOW_ORIGINAL_VALUES:2,SHOW_ARRAYS:4,init:(e=2)=>{const a=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(...r){const t=a.call(this,...r);return r[0].startsWith("webgl")?o(t,(s=e,c=2,n=20,Math.max(s,Math.min(c,n)))):t;var s,c,n}},instances:[]},console.log(`%cPWGL Debugger v${PWGLDebugger.version}\nhttps://github.com/asjs-dev/pwgl`,"background:#222;color:#0F0");
