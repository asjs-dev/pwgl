(()=>{var $="removeEventListener,addEventListener,textureProps,lightRenderer,filterRenderer,getOwnPropertyNames,repeatX,object,renderToFramebuffer,touchmove,unregisterLight,touchstart,mousedown,mousemove,touchend".split(",");"use strict";var $m=Math,$w=window,$n=null,$o=Object;var FPS={init(){this.fps=this.delay=this._$c=this._$k=this._$t=0;this._$c=Date.now();this._$v=1e3/60},update(){var b=Date.now();this.delay=(b-this._$c)/this._$v;this._$c=b;this._$k++;if(b>=this._$t+1e3){this.fps=(this._$k*1e3)/(b-this._$t);this._$t=b;this._$k=0}}};FPS.start=FPS.init;class PressState{constructor(){this._$g={};this._$x={};this._$w={}};isDown(b){return this._$g[b]===0};isUp(b){return this._$g[b]===1};isPressed(b){return this.isUp(b)&&this._$w[b]<=200};isLongPressed(b){return this.isUp(b)&&this._$w[b]>200};update(){for(var c in this._$g)if(this._$g[c]>0){delete this._$g[c];delete this._$w[c];delete this._$x[c]}};$setDownState(b){this._$g[b]=0;this._$x[b]=Date.now()};$setUpState(b){var d=Date.now();this._$g[b]=1;this._$w[b]=d-this._$x[b];this._$x[b]=d}};class Mouse extends PressState{constructor(c){super();this.position={x:0,y:0};this._$l=c??$w;this._$r={mousedown:1,mouseup:1,touchstart:0,touchend:0};this._$E=this._$E.bind(this);this._$y=this._$y.bind(this);this._$F=this._$F.bind(this);this._$l[$[1]]($[12],this._$E);this._$l[$[1]]("mouseup",this._$y);this._$l[$[1]]($[13],this._$F);this._$l[$[1]]($[11],this._$E);this._$l[$[1]]($[14],this._$y);this._$l[$[1]]($[9],this._$F)};destruct(){this._$l[$[0]]($[12],this._$E);this._$l[$[0]]("mouseup",this._$y);this._$l[$[0]]($[13],this._$F);this._$l[$[0]]($[11],this._$E);this._$l[$[0]]($[14],this._$y);this._$l[$[0]]($[9],this._$F)};_$E(b){if(this._$r[b.type]===b.which){this.$setDownState(0)}};_$y(b){if(this._$r[b.type]===b.which){this.$setUpState(0)}};_$F(b){var d=b.type===$[9]?b.touches[0]:b;this.position.x=d.clientX;this.position.y=d.clientY}};class Keyboard extends PressState{constructor(c){super();this._$l=c??$w;this._$z=this._$z.bind(this);this._$s=this._$s.bind(this);this._$l[$[1]]("keydown",this._$z);this._$l[$[1]]("keyup",this._$s)};destruct(){this._$l[$[0]]("keydown",this._$z);this._$l[$[0]]("keyup",this._$s)};_$z(b){this.$setDownState(b.keyCode)};_$s(b){this.$setUpState(b.keyCode)}};class Gamepad{get gamepads(){return navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads||[]};get(b){var f=this.gamepads[b];return f?{axes:f.axes.map((c)=>$m.abs(c)>=.05?c:0),buttons:f.buttons.map((d)=>typeof d==="number"?{pressed:d===1,touched:d===1,value:d}:d),timestamp:f.timestamp}:$n}};var areObjectsEqual=(a,b)=>{if(typeof a!==typeof b)return!1;if(typeof a!==$[7])return a===b;var c=$o[$[5]](a);var d=$o[$[5]](b);if(c.length!==d.length)return!1;var f,av,bv,subeq;var i=c.length;while((f=c[--i])){av=a[f];bv=b[f];if(av!==bv){subeq=!1;if(typeof av===$[7]&&typeof bv===$[7])subeq=areObjectsEqual(av,bv);if(!subeq)return!1}};return!0};var clone=(c)=>{if(typeof c!==$[7]||c===$n||c===undefined)return c;var d=Array.isArray(c)?[]:{};var f=$o[$[5]](c);var b;var i=f.length;while((b=f[--i]))d[b]=typeof c[b]===$[7]?clone(c[b]):c[b];return d};class DataObserver{constructor(c={}){this._$g=c;this._$A=clone(this._$g);this._$b=!1;this._$B=this._$B.bind(this);this._$B()};start(){this._$b=!0};stop(){this._$b=!1};_$B(){if(this._$b&&!areObjectsEqual(this._$g,this._$A)){var b=clone(this._$g);var d=clone(this._$A);this._$m(b,d);this._$A=b};requestAnimationFrame(this._$B)}};class SmoothLight extends AGL.Image{constructor(b={}){super();this._$G=new AGL.Framebuffer();this[$[3]]=new AGL.LightRenderer(b);this._$n=new AGL.BlurFilter();this[$[4]]=new AGL.FilterRenderer({config:{context:this[$[3]].context},sourceTexture:this._$G,filters:[this._$n]});this[$[4]].clearColor.set(0,0,0,0);this[$[4]].clearBeforeRender=!0;this.registerLight=this[$[3]].registerLight.bind(this[$[3]]);this[$[10]]=this[$[3]][$[10]].bind(this[$[3]]);this.blendMode=AGL.BlendMode.SHADOW;this._$H=new AGL.Framebuffer();this.texture=this._$H;this.blur=typeof b.blur==="number"?b.blur:1};get blur(){return this._$d};set blur(v){this._$d=this._$n.intensityX=this._$n.intensityY=v};render(){this._$C();this[$[3]][$[8]](this._$G);this[$[4]][$[8]](this._$H)};setSize(w,h){this._$h=w;this._$p=h;this._$C=this._$q};_$q(){this._$C=()=>{};this[$[3]].setSize(this._$h,this._$p);this[$[4]].setSize(this._$h,this._$p)}};class WaterRenderer extends AGL.Container{constructor(l,b){super();this._$j=b;this._$h=1;this._$p=1;var n=AGL.Texture.loadImage(l);n.magFilter=AGL.Const.LINEAR;this._$I=new AGL.Image(n);this._$I[$[2]][$[6]]=.7;this._$I.tintType=AGL.Image.TintType.GRAYSCALE;this._$I.color.set(0,.1,.75,1);this.addChild(this._$I);this._$J=new AGL.Image(n);this._$J.blendMode=AGL.BlendMode.ADD;this._$J[$[2]][$[6]]=4;this._$J[$[2]].repeatRandomRotation=1;this._$J.tintType=AGL.Image.TintType.GRAYSCALE;this._$J.color.set(0,.06,.75,1);this.addChild(this._$J);this._$D={x:0,y:0};this._$f=0};setSize(w,h){this._$h=w;this._$p=h;var c=h/w;this._$J.props.width=this._$I.props.width=w;this._$J.props.height=this._$I.props.height=h;this._$J[$[2]].repeatY=this._$J[$[2]][$[6]]*c;this._$I[$[2]].repeatY=this._$I[$[2]][$[6]]*c};render(d){var j=this._$j*d;var k=j*2;this._$f+=j*2.5;var f=$m.sin(this._$f)*.3;var g=$m.cos(this._$f)*.3;var m;m=this._$I[$[2]];m.x=this._$D.x*m[$[6]]+((j*.75+f)%1);m.y=this._$D.y*m.repeatY+((k*.75+g)%1);m=this._$J[$[2]];m.x=this._$D.x*m[$[6]]+((j-f)%1);m.y=this._$D.y*m.repeatY+((k-g)%1)};move(x,y){this._$D.x=x/this._$h;this._$D.y=y/this._$p}};var clamp=(b,c,d)=>$m.max(b,$m.min(c,d));var cross=(a,b)=>a.x*b.y-a.y*b.x;var dot=(a,b)=>a.x*b.x+a.y*b.y;var distanceBetweenPointAndLine=(p,l)=>{var j={x:l.b.x-l.a.x,y:l.b.y-l.a.y};var k={x:p.x-l.a.x,y:p.y-l.a.y};var m={x:p.x-l.b.x,y:p.y-l.b.y};var n=dot(j,k)<0;var q=dot(j,m)>0;if(!n&&!q)return $m.abs(cross(j,k))/$m.hypot(j.x,j.y);var P=n?k:m;return $m.hypot(P.x,P.y)};var areTwoLinesCollided=(r,s)=>{var a=r.b.y-r.a.y;var b=r.b.x-r.a.x;var c=s.b.y-s.a.y;var d=s.b.x-s.a.x;var t=b*c-d*a;if(t!==0){var e=s.b.x-r.a.x;var f=s.a.x-s.b.x;var g=s.b.y-r.a.y;var h=r.a.y-r.b.y;var y=(c*e+f*g)/t;var v=(h*e+b*g)/t;if(0<y&&y<1&&0<v&&v<1)return{y,v}};return $n};var lineToLineIntersection=(r,s)=>{var z=areTwoLinesCollided(r,s);return z?{x:r.a.x+(r.b.x-r.a.x)*z.lambda,y:r.a.y+(r.b.y-r.a.y)*z.lambda}:$n};var areTwoRectsCollided=(w,x)=>w.width>x.x&&w.x<x.width&&w.height>x.y&&w.y<x.height;var rectToRectIntersection=(w,x)=>areTwoRectsCollided(w,x)?{x:$m.max(w.x,x.x),y:$m.max(w.y,x.y),width:$m.min(w.width,x.width),height:$m.min(w.height,x.height)}:$n;var collisionDetection={distanceBetweenPointAndLine,areTwoLinesCollided,lineToLineIntersection,areTwoRectsCollided,rectToRectIntersection};var enterFrame=(f)=>{var h;var g=!1;var d=()=>{if(g){FPS.update();f(FPS.fps,FPS.delay);h=requestAnimationFrame(d)}};var c=()=>{if(!g){g=!0;FPS.init();d()}};var b=()=>{cancelAnimationFrame(h);g=!1};c();return{c,b,get isPlaying(){return g}}};var enumCheck=(c,b)=>(c&b)===b;var fract=(f)=>f%1;var getFPS=async()=>new Promise((d)=>{requestAnimationFrame((c)=>requestAnimationFrame((b)=>d($m.round(1e3/(b-c)))))});var nthCall=(g,b,d=0)=>{var f=b-(d+1);return(...c)=>(f=f>-1?(1+f)%b:++f)===0&&g(...c)};var hash=1;var rand=(x,y,b)=>(hash=$m.abs(fract(hash*(.12+34.56*x+b*y*78.9))));var fixRand=(x,y,b)=>fract($m.sin(dot({x,y},{x:$m.sin(x+y),y:$m.cos(y-x)*b}))*b)*.5+.5;var random={rand,fixRand};$w.PWGLExtensions=$w.AGLExtensions={FPS,PressState,Mouse,Keyboard,Gamepad,DataObserver,SmoothLight,WaterRenderer,areObjectsEqual,clamp,clone,collisionDetection,cross,dot,enterFrame,enumCheck,fract,getFPS,nthCall,random};})();